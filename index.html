<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Clash of Vikings</title>
<link rel="shortcut icon" href="icon.png">
<meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<link rel="stylesheet" type="text/css" href="game.css">
<script src="jquery.min.js"></script>
<script src="game.js"></script>
</head>

<body>
<div class="gamecenter-activator"></div>

<div id="ajaxbar">
    <div id="game"><canvas id="canvas"></canvas></div>
    <div id="orientate" style="display:none;">
        <img src="media/graphics/orientate/landscape.jpg" />
    </div>
    <div id="play" class="play"><img src="media/graphics/splash/mobile/cover-start.jpg" /></div>
</div>

<script>
(function() {
    function GameLoader() {
        this.init = function() {
            this._gameId = "a6p4tlld8eme6p5vipqs2xxwxiwh5rng";
            this._container = document.getElementById("game");
            this._loader = this._getLoaderData();
            this._hasImpression = false;
            this._hasSuccess = false;
            this._insertGameSDK();
        };

        this._getLoaderData = function() {
            return {enabled:true};
        }

        this._insertGameSDK = function() {
            if (!this._gameId) return;

            window.SDK_OPTIONS = {
                gameId: this._gameId,
                loader: this._loader,
                onLoaderEvent: this._onLoaderEvent.bind(this),
                onEvent: this._onEvent.bind(this)
            };

            (function(a,b,c){
                var d=a.getElementsByTagName(b)[0];
                if(!a.getElementById(c)) {
                    var s = a.createElement(b);
                    s.id = c;
                    s.src = "https://api.gamemonetize.com/sdk.js";
                    d.parentNode.insertBefore(s,d);
                }
            })(document,"script","gamemonetize-sdk");
        };

        this._onLoaderEvent = function(event) {
            if(event.name === "LOADER_DATA") {
                this._bridge = event.message.bridge;
                this._game = event.message.game;
            }
        };

        this._onEvent = function(event) {
            switch(event.name) {
                case "SDK_GAME_START":
                    if(this._bridge) {
                        this._bridge._loadGame({
                            hasImpression: this._hasImpression,
                            display:true
                        });
                    }
                    break;
                case "AD_ERROR":
                case "AD_SDK_CANCELED":
                    this._hasImpression = false || this._hasSuccess;
                    break;
                case "ALL_ADS_COMPLETED":
                case "COMPLETE":
                case "USER_CLOSE":
                case "SKIPPED":
                    this._hasImpression = true;
                    this._hasSuccess = true;
                    break;
            }
        };
    }

    new GameLoader().init();
})();
</script>

<script>
(function(a,b,c){
    var d=a.getElementsByTagName(b)[0];
    if(!a.getElementById(c)){
        var s = a.createElement(b);
        s.id = c;
        s.src = "https://api.gamemonetize.com/sdk_mobile.js?v=" + Date.now();
        d.parentNode.insertBefore(s,d);
    }
})(document,"script","gamemonetize-mobile-api");
</script>

</body>
</html>
